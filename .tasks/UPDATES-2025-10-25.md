# Task Plan Updates - 2025-10-25

## Critical Changes Made

Based on user feedback, the following critical updates have been implemented:

### 1. ✅ TypeScript-First Requirement

**Change**: Project is now strictly TypeScript, no vanilla JavaScript allowed.

**Implementation**:
- Updated CLAUDE.md with explicit TypeScript requirements
- All task descriptions now specify TypeScript implementation
- ESLint configured to error on `any` types
- Type checking integrated into build process (`npm run build`)

**Impact**: All new code files must be:
- `.ts` for TypeScript
- `.svelte` with `<script lang="ts">` for components
- No `.js` files in `src/` directory

### 2. ✅ Quality Tools as Part of Build Process

**Change**: Linting and quality checking are now mandatory build steps.

**Implementation**:
- Created `eslint.config.js` with ESLint 9 flat config
- Created `.prettierrc.json` with Svelte plugin
- Updated `package.json` with quality scripts:
  - `npm run type-check` - TypeScript compilation check
  - `npm run lint` - ESLint validation  
  - `npm run format:check` - Prettier formatting check
  - `npm run check` - Runs all quality gates
  - `npm run build` - Now includes type checking

**New Dependencies Added**:
```json
"@eslint/js": "^9.15.0",
"@typescript-eslint/eslint-plugin": "^8.15.0",
"@typescript-eslint/parser": "^8.15.0",
"eslint-plugin-svelte": "^3.12.5",
"globals": "^15.12.0",
"svelte-eslint-parser": "^0.46.0",
"@vitest/coverage-v8": "^4.0.3"
```

**ESLint Rules** (Svelte 5 + TypeScript Best Practices):
- `@typescript-eslint/no-explicit-any`: error
- `@typescript-eslint/explicit-function-return-type`: warn
- `@typescript-eslint/consistent-type-imports`: error
- `svelte/no-deprecated-dollar-labels-in-runes-mode`: error
- `no-console`: warn (except console.warn/error)

**Impact**: Every commit must pass:
1. Type checking (0 errors)
2. Linting (0 errors/warnings)
3. Format checking
4. All tests

### 3. ✅ Tests Integrated into Each Task

**Change**: Testing is no longer a separate phase - it's part of every task.

**Old Approach** (REMOVED):
- Tasks 45-47 were separate "testing phase"
- Tests written after all features complete
- Risk of untested code accumulating

**New Approach** (IMPLEMENTED):
- Every task includes test requirements
- Tests written DURING feature implementation
- Test-driven development encouraged
- No separate testing phase

**Impact**:
- Tasks 45-47 are REMOVED/ABSORBED into other tasks
- Total tasks reduced from 50 to 47
- Each task now includes:
  - Unit tests (for services/utilities)
  - Integration tests (for components)
  - E2E tests (for critical workflows, when applicable)

**Task Completion Criteria** (Updated):
A task is only complete when:
- [ ] Feature implemented in TypeScript
- [ ] All tests written and passing
- [ ] Type checking passes
- [ ] Linting passes
- [ ] Formatting passes
- [ ] Code coverage >80% for new code
- [ ] Build succeeds

### 4. Task 01 Updated

Task 01 now includes quality tools setup:
- **Part A**: ESLint, Prettier, TypeScript configuration
- **Part B**: Carbon Design System integration

This ensures quality infrastructure is in place from the start.

## Updated File Structure

```
c:\rd\CHUCC-SQUI\
├── eslint.config.js          ← NEW: ESLint 9 flat config
├── .prettierrc.json          ← NEW: Prettier config
├── .prettierignore           ← NEW: Prettier ignore patterns
├── package.json              ← UPDATED: Quality scripts & dependencies
├── tsconfig.json             ← EXISTS: Strict TypeScript config
├── .claude/
│   └── CLAUDE.md             ← UPDATED: TypeScript & quality requirements
└── tasks/
    ├── 01-carbon-integration.md  ← UPDATED: Includes quality tools
    ├── MASTER-TASKS.md       ← TO UPDATE: Remove tasks 45-47
    ├── task-index.md         ← TO UPDATE: Renumber/clarify
    ├── IMPLEMENTATION-GUIDE.md ← TO UPDATE: Reflect changes
    └── UPDATES-2025-10-25.md ← THIS FILE
```

## Commands Cheat Sheet

### Before Starting Any Task
```bash
npm install  # Install dependencies (including new ESLint packages)
```

### During Development
```bash
npm run dev          # Start dev server
npm run type-check   # Check TypeScript (in separate terminal)
npm test             # Run tests in watch mode
```

### Before Committing (Quality Gate)
```bash
npm run check        # Run all quality checks
# This runs: type-check && lint && format:check && test:unit
```

### Auto-Fix Issues
```bash
npm run lint:fix     # Auto-fix ESLint issues
npm run format       # Auto-format with Prettier
```

### Build
```bash
npm run build        # Build for production (includes type-check)
```

## Migration Notes for Existing Code

If any code already exists:

1. **Rename `.js` to `.ts`**:
   ```bash
   # For any existing .js files in src/
   mv src/file.js src/file.ts
   ```

2. **Add TypeScript to Svelte components**:
   ```svelte
   <!-- Change this: -->
   <script>
   
   <!-- To this: -->
   <script lang="ts">
   ```

3. **Run quality checks**:
   ```bash
   npm run check
   # Fix any errors reported
   ```

4. **Update to Svelte 5 runes**:
   - Replace `$:` with `$derived` or `$effect`
   - Replace `export let prop` with `let { prop } = $props()`

## Next Steps

1. ✅ Run `npm install` to get new dependencies
2. ✅ Verify quality tools work: `npm run check`
3. ✅ Start with Task 01 (now includes quality setup)
4. ✅ Every subsequent task: implement → test → quality check → commit
5. 📝 Update remaining task documentation (MASTER-TASKS, etc.)

## Questions?

- **TypeScript errors?** → Run `npm run type-check` and fix reported issues
- **Linting errors?** → Run `npm run lint:fix` for auto-fixes
- **Format errors?** → Run `npm run format` to auto-format
- **Test failures?** → Check test output and fix implementation
- **Build failing?** → Run each check individually to isolate issue

---

**Summary**: The project is now TypeScript-first with quality gates enforced at build time, and testing is integrated into every task instead of being a separate phase. This ensures higher code quality from the start!
